\documentclass[reqno]{amsart}


\input{preamble.tex}



\title{MFSURP}

\author{Jessica Chen}
\address{
Carnegie Mellon University\\
Pittsburgh, PA 15213, USA
}
\email[J. Chen]{jschen2@andrew.cmu.edu}


\author{Linxuan Jiang}
\address{
Carnegie Mellon University\\
Pittsburgh, PA 15213, USA
}
\email[L. Jiang]{linxuanj@andrew.cmu.edu}

\author{Frank Sacco}
\address{
Carnegie Mellon University\\
Pittsburgh, PA 15213, USA
}
\email[F. Sacco]{fsacco@andrew.cmu.edu}

\author{Albert Zhang}
\address{
Carnegie Mellon University\\
Pittsburgh, PA 15213, USA
}
\email[A. Zhang]{albertzh@andrew.cmu.edu}

\thanks{J. Chen, L. Jiang, F. Sacco, A. Zhang were supported by MFSURP \dots }

\keywords{Blachelier model, Chooser options, \dots}


\begin{document}


\begin{abstract}
    This paper concerns \dots 
\end{abstract}



\maketitle  
\tableofcontents

\section{Introduction}

\subsection{Arbitrage-free pricing}


\subsection{The Blachelier Model}
In this paper we work within the context of the \emph{Blachelier model}, where the stock prices $\{S_t\}_{t \ge 0}$ evolves according to 
\begin{align}\label{eq: r not 0}
	 S_t = e^{rt} \left( S_0 + \kappa^{-rt}W_t + \kappa r \int_0^t e^{-rs} W_s \; ds \right).
\end{align}
where $S_0 > 0$ and $\{W_t\}_{t \ge 0}$ is a Brownian motion under the risk neutral measure $\tilde{\mathbb{P}}$. We note to the reader that when $r = 0$, this reduces to 
\begin{align}\label{eq: r=0}
      S_t = S_0 + \kappa W_t. 
\end{align}

\subsection{Notation and conventions}

In this paper we often use the notation $f^+$ to denote $\max(f,0)$. We note that by definition, we have 
\begin{align}\label{eq: pos part decomp}
      f = f^+ - (-f)^+.
\end{align}



\section{Asian options}
In this section we derive the arbitrage-free prices of some contracts in the simplest setting when $r = 0$.  

\subsubsection{European Call}
We first consider a European call where the payoff at time $T$ is given by 
\begin{align}
	 V_T = (S_T - K)^+.
\end{align}
We note that under $\tilde{\mathbb{P}}$, $ W_T \sim N(0, T)$, therefore
\begin{align}\label{eq: S_T dist}
S_T \sim N(S_0, \kappa^2T) \; \text{under the risk neutral measure} \; \tilde{\mathbb{P}}.
\end{align}

According to the risk neutral pricing formula, the time-0 price of this security is given by 
\begin{align}
	 V_0 = \tilde{\E}[(S_T - K)^+].
\end{align}
Recall that if we have a random variable $X$ with probability density function $f_X$ under a probability measure $\mathbb{P}$, then the ``law of the unconscious statistician'' tells us that 
\begin{align}
	 \E[g(X)] = \int_{-\infty}^\infty g(x) f_X(x) \; dx.
\end{align}
In our setting, we have 
\begin{align}
	 g(S_T) = (S_T - K)^+,
\end{align}
and the distribution of $S_T$ under $\tilde{\bP}$ as a random variable is given in \eqref{eq: S_T dist}. Therefore 
\begin{align}\label{eq: call int}
	 V_0 = \tilde{\E}[(S_T - K)^+] =  \tilde{\E}[g(S_T)] = \int_{-\infty}^\infty (x-K)^+ \psi(x) \; dx,
\end{align}
where 
\begin{align}
	 \psi(x) = \frac{1}{\nu}\varphi\left(\frac{x-\mu}{\nu}\right), \; \varphi(y) = \frac{1}{\sqrt{2\pi}}e^{-y^2/2}, 
\end{align}
and
\begin{align}
	 \mu = S_0, \; \nu = \kappa \sqrt{T}.
\end{align}
To compute \eqref{eq: call int}, we first note that since $(x-K)^+ = 0$ for $x \le K$, the domain of integration is the set $\{x \mid x \ge K\}$. Now we use the change of variables 
\begin{align}
	 y = -\frac{x-\mu}{\nu} \Longleftrightarrow x = \mu - \nu y
\end{align}
and we note that since $\nu > 0$, 
\begin{align}
	 x \ge K \Longleftrightarrow \frac{x-\mu}{\nu} \ge \frac{K - \mu}{\nu} \Longleftrightarrow y \le \frac{\mu - K}{\nu} =: d_-.
\end{align}
Then by performing a change of variables, \eqref{eq: call int} becomes 
\begin{align}
	 V_0 = \int_{-\infty}^{d_-} (\nu y + K - \mu) \varphi(-y) \; dy = \int_{-\infty}^{d_-} (\nu y + K - \mu) \varphi(y) \; dy = \underbrace{\int_{-\infty}^{d_-} \nu y \varphi(y) \; dy}_{:= I} + \underbrace{\int_{-\infty}^{d_-}  (K-\mu)\varphi(y) \; dy}_{:= II}.
\end{align}
We define the cumulative distribution function of a standard normal random variable $X$ under $\mathbb{P}$ via 
\begin{align}
	 \Phi(x) = \mathbb{P}[X \le x] = \E[ \mathbbm{1}_{X \le x}] = \int_{-\infty}^x \varphi(y) \; dy.
\end{align}
With this notation in hand, we can write 
\begin{align}
	 II = (K-\mu) \int_{-\infty}^{d_-} \varphi(y) \; dy = (K-\mu) \Phi(d_-),
\end{align}
and 
\begin{align}
	 I = \nu \int_{-\infty}^{d_-} y \varphi(y) \; dy =  \frac{\nu}{\sqrt{2\pi}} \lim_{t \to -\infty} (e^{-t^2/2} - e^{-d_-^2/2}) = -\frac{\nu}{\sqrt{2\pi}} e^{-d_-^2/2}.
\end{align}
Therefore 
\begin{align}
	 V_0 =  -\frac{\nu}{\sqrt{2\pi}} e^{-d_-^2/2} + (K-\mu) \Phi(d_-).
\end{align}
To compute the price of a put, one can use put-call parity. 
\subsubsection{Arithmetic Asian call}
Consider an arithmetic Asian call where the payoff at time $T$ is given by 
\begin{align} \label{eq: asian}
	 V_T = (A_T - K)^T, \; A_T = \frac{1}{T}\int_0^T S_t \; dt = S_0 + \frac{\kappa}{T} \int_0^T W_t \; dt. 
\end{align}
Using Ito's formula, one can show that under the risk neutral measure $\tilde{\mathbb{P}}$, 
\begin{align}
	 \int_0^T W_t \; dt \sim N(0, T^3/3).
\end{align}
Therefore we have 
\begin{align}
	 A_T \sim N(S_0, \kappa^2 T/3) \; \text{under the risk neutral measure} \; \tilde{\mathbb{P}}.
\end{align}
Comparing this to \eqref{eq: S_T dist}, we see that $A_T$ has a similar distribution, the only difference is that the variance of $A_T$ is smaller by a factor of $1/3$, so the standard deviation of $A_T$ is smaller by a factor of $1/\sqrt{3}$. By performing the exact same set of calculation as before, the time-0 price of an Asian option is 
\begin{align} \label{eq: asian op}
	 V_0 = -\frac{\nu}{\sqrt{3}\sqrt{2\pi}} e^{-3d_-^2/2} + (K-\mu) \Phi(\sqrt{3}d_-),
\end{align}
where 
\begin{align}
	 \mu = S_0, \; \nu = \kappa \sqrt{T}, \; d_- = \frac{\mu - K}{\nu}.
\end{align}
We note that since $\sqrt{3} > 1$, we see from \eqref{eq: asian op} that the price of an Asian option is higher than the price of a European call. This should be expected as one is paying a premium for a less volatile product. 

\section{Chooser options}
In this section we consider a more complicated type of financial contracts known as \emph{chooser options}. These are contracts with a fixed maturity date $T$ and a strike price $K$, and an agent is allowed to decide on a choosing date $\tau < T$ to choose the underlying derivative in the contract. Many results are known when an agent is allowed to choose between a European call and a European put; we are interested in a variant of this type of contract that allows an agent to decide between two securities that pays 
\begin{align}
     C_T = (A_T - K)^+, \; P_T = (K - A_T)^+,
\end{align}
where $A_T$ is defined via \eqref{eq: asian}.
Here, we assume the agent chooses optimally with no outside information. At time $\tau$, the agent will choose the option of higher value between the put and call, therefore the value of this contract at time $\tau$ is 
\begin{align}\label{eq: V_tau}
     V_\tau = \max(C_\tau, P_\tau).
\end{align}
By properties of the max function (FIXME: maybe add this in intro and reference?)
\begin{align}
     V_\tau = C_\tau + \max(0, P_\tau - C_\tau).
\end{align}
Note that by \eqref{eq: pos part decomp}, we have
\begin{align}
     P_T - C_T = (K-S_T)^+ - (S_T - K)^+ = K - A_T. 
\end{align}
Next we want to identify the time-$\tau$ prices of contracts paying $P_T - C_T$ and $K - A_T$ at time $T$. To compute these arbitrage prices, we use the method of replication.

We can replicate the LHS of the above equation by going long a put and short a call at time $0$, both with strike $T$. 
We also replicate the RHS by investing $Ke^{-rT}$ into the bank at time 0 and shorting a contract to receive $A_T$ at time $T$. 
Since both portfolios are of equal price at time $T$, they have equal price at all times $t$ where $0 \leq t \leq T$. 
At time $\tau$, the left portfolio is the value of the put minus the call at time $\tau$. 
The right portfolio now has $Ke^{-rT + r\tau}$ in the bank and is short a contract which pays $A_T$ at $T$.
Define $P_\tau$ and $C_\tau$ to be the respective values of a put and call with maturity $T$ at time $\tau$.
Let $A_\tau$ be the value of the contract at time $\tau$ to receive $A_T$ at time $T$.
By replication, our portfolios give us the following equation
\begin{align}
     P_\tau - C_\tau = Ke^{r(\tau - T)} - A_\tau.
\end{align}
Substituting this result back into \eqref{eq: V_tau}, the value of the contract $V$ at $\tau$ is
\begin{align}
     V_\tau = C_\tau + \max(0, Ke^{r(\tau - T)} - A_\tau).
\end{align}
Our next goal is to find an explicit formula for $A_\tau$. 

For simplicity, we define $U_\tau$ to be the time $\tau$ price of a contract with payoff $Y_T$ at time $T$, where $Y_T$ is defined via
\begin{align}\label{eq: y}
     Y_T = \int_0^T S_t \; dt.
\end{align}
Once $U_tau$ is determined, then we can recover $A_\tau$ as $A_\tau = \tau U_\tau$. 

Note that \eqref{eq: y} can be split into
two parts, 
\begin{align}
     Y_T = \int_0^\tau S_t \; dt + \int_\tau^T S_t \; dt.
\end{align}
Observe that the integral from $0$ to $\tau$ is known at time $\tau$ as each price $S_t$ will be known by the time $\tau$. So we can treat this integral as a constant and now try to replicate the integral from time $\tau$ to $T$.

We begin our replicating strategy by buying $x$ shares of stock at time $\tau$. For all times $t$ where $\tau \leq t \leq T$, we will continuously sell off stock at the rate $\alpha_t$ and invest the revenue.
With this strategy, at time T, the bank has 

\begin{align}
     \int_\tau^T \alpha_t S_t e^{r(T-t)} \; dt
\end{align}

To finish the replication, we want our replicating portfolio to be equal to the integral we are replicating:

\begin{align}
     \int_\tau^T \alpha_t S_t e^{r(T-t)} \; dt = \int_\tau^T S_t \; dt.
\end{align}

Solving for $\alpha_t$, we find that

\begin{align}
     \alpha_t = e^{r(t-T)}
\end{align}

Thus, the amount of shares our strategy started with was

\begin{align}
     x = \int_\tau^T e^{r(t-T)} \; dt = \dfrac{1}{r} - \dfrac{e^{r(\tau - T)}}{r}.
\end{align}

This tells us that the cost at time $\tau$ to receive the stock from times $\tau$ to $T$ continuously is $x S_\tau$. This gives us 

\begin{align}
     U_\tau = \int_0^\tau S_t \; dt + \dfrac{S_\tau}{r}\left( 1 - e^{r(\tau - T)} \right)
\end{align}

Recall that $w_\tau$ is the price at time $\tau$ to receive $A_T$, equivalent to $\dfrac{Y_T}{T}$, at time T.
Thus, the price at $\tau$ to receive just $A_T$ is 

\begin{align}
     w_\tau = \dfrac{U_\tau}{T} = \dfrac{\int_0^\tau S_t \; dt + \dfrac{S_\tau}{r}\left( 1 - e^{r(\tau - T)} \right)}{T}
\end{align}

Returning to 1.6 Put-Call Parity, we can write out the equation as

\begin{align}
     P_\tau - C_\tau = Ke^{r(\tau - T)} - \dfrac{\int_0^\tau S_t \; dt + \dfrac{S_\tau}{r}\left( 1 - e^{r(\tau - T)} \right)}{T}.
\end{align}

Substituting this into the chooser option from 1.7, the value of $V_\tau$ is

\begin{align}
     V_\tau = C_\tau + \max(0, Ke^{r(\tau - T)} - \dfrac{\int_0^\tau S_t \; dt + \dfrac{S_\tau}{r}\left( 1 - e^{r(\tau - T)} \right)}{T})
\end{align}

(insert simplification for when r != 0)

The above formula breaks when $r = 0$ since we divide by $r$. To fix this, we return to our replicating strategy for $w_\tau$ accounting for this special case.

Define $U_\tau$ and $Y_T$ the same way as above. Again, split the integral $Y_T$ such that

\begin{align}
     Y_T = \int_0^\tau S_t \; dt + \int_\tau^T S_t \; dt
\end{align}

We now replicate the integral from time $\tau$ to $T$ for the special case. We follow the same replicating strategy as before. Purchase $x$ shares of stock. For all times $t$ where $\tau \leq t \leq T$, we continuously sell off at the rate $\alpha_t$ and invest the revenue. 
By time $T$, the bank will have 

\begin{align}
     \int_\tau^T \alpha_t S_t \; dt
\end{align}

We finish the replication by setting this equal to the value we're replicating

\begin{align}
     \int_\tau^T \alpha_t S_t \; dt = \int_\tau^T S_t \; dt
\end{align}

Solving for $\alpha_t$, we see that when $r = 0$ that $\alpha_t = 1$. Thus, the number of shares the strategy started with was

\begin{align}
     \int_\tau^T dt = T - \tau
\end{align}

Similar to the $r \neq 0$ case, it then follows that

\begin{align}
     U_\tau = \int_0^\tau S_t dt + S_\tau (T - \tau), \; w_\tau = \dfrac{U_\tau}{T} = \dfrac{\int_0^\tau S_t dt + S_\tau (T - \tau)}{T}
\end{align}

Thus, Put-Call Parity in the special case tells us that 

\begin{align}
     P_\tau - C_\tau = K - \dfrac{U_\tau}{T} = \dfrac{\int_0^\tau S_t dt + S_\tau (T - \tau)}{T}.
\end{align}

Substituting this result into the chooser option formula, we have

\begin{align}
     V_\tau = C_\tau + \max(0, K - \dfrac{\int_0^\tau S_t \; dt + S_\tau (T - \tau)}{T})
\end{align}

Note that when the interest rate is $0$, the stock prices evolve according to 

\begin{align}
     S_t = S_0 + \kappa W_t
\end{align}

where $S_0 > 0$ and $\{W_t\}_{t \ge 0}$ is a Brownian motion under the risk neutral measure. We can now rewrite our chooser option formula as

\begin{align}
     V_\tau = C_\tau + \max(0, K - \dfrac{\int_0^\tau \left( S_0 + \kappa W_t \right) \; dt + (S_0 + \kappa W_\tau) (T - \tau)}{T})
\end{align}

So in conclusion, we find that 
\begin{align}
     V_\tau = C_\tau + \left(K- S_0 - \frac{\kappa(T-\tau)}{T} W_\tau - \frac{\kappa}{T} \int_0^\tau W_t \; dt  \right)^+.
\end{align}
Then by the risk-neutral pricing formula, the time-zero price of this contract is given by 

\begin{align} \label{eq: expect form}
     V_0 = \tilde{\E}(C_\tau) + \tilde{\E}\left(\left(K- S_0 - \frac{\kappa(T-\tau)}{T} W_\tau - \frac{\kappa}{T} \int_0^\tau W_t \; dt  \right)^+\right).
\end{align}

Let 
\begin{align}
     X &= \tilde{\E}(C_\tau) + \tilde{\E}\left(\left(K- S_0 - \frac{\kappa(T-\tau)}{T} W_\tau - \frac{\kappa}{T} \int_0^\tau W_t \; dt  \right)^+\right).
\end{align}

It follows that the mean and variance of $X$ can be computed as 
\begin{align}
     \mu &= \E(X) = 0\\
     \sigma &= Var(X) = \tau(\frac{\kappa(T-\tau)}{T})^2 + \frac{\tau^3}{3}(\frac{\kappa}{T})^2 + \tau^2\frac{\kappa^2(T-\tau)}{T^2}.\\
     \nu &= \sqrt{\sigma}\\
\end{align}

We can show that $X$ is normally distributed, but this proof has been ejected as it is beyond the scope of this research. Therefore we can define the probability density function as
\begin{align}
     \phi(x) &=\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}\\
     \psi(x) &= \frac{1}{\nu}\phi(\frac{x-\mu}{\nu})
\end{align}

Now we can substitute back into our equation from \eqref{eq: expect form} and use the definition of expectation on a continuous random variable to get 

\begin{align} \label{eq: prechange}
     V_0 = \tilde{\E}(C_\tau) + \left(\int_{-\infty}^{\infty}\left(K- S_0 - X\right)\psi(X) \; dX\right)^+.
\end{align}

To integrate the second term in $V_0$ we will let

\begin{align}
     Z &= \frac{X-\mu}{\sigma}.
\end{align}

it follows that 
\begin{align}\label{eq: change variable}
     X &= Z\nu + \mu\\
     dX &= \nu dZ.
\end{align}

Note that the second term can only be positive when 
\begin{align}
     X \leq K - S_0.
\end{align}

Which is equivalent to 
\begin{align} \label{eq: bound}
     \frac{X-\mu}{\sigma} \leq \frac{K-S_0-\mu}{\nu}
\end{align}

let
\begin{align}
     d_ = \frac{K-S_0-\mu}{\nu}.
\end{align}

then \eqref{eq: bound} is 

\begin{align} \label{eq: change bound}
     Z \leq d_.
\end{align}

Now using \eqref{eq: change variable} and \eqref{eq: change bound} we can rearrange \eqref{eq: prechange} as:

\begin{align}
     V_0 = \tilde{\E}(C_\tau) + \left(\int_{-\infty}^{d\_}\left(K- S_0 - Z\nu - \mu\right)\frac{1}{\nu}\phi(Z)\nu \; dZ\right).
\end{align}

Simplifying this expression we get the form
\begin{align}
     V_0 = \tilde{\E}(C_\tau) + (K- S_0 - \mu)\int_{-\infty}^{d\_}\phi(Z) \; dZ - \nu \int_{-\infty}^{d\_}Z\phi(Z)\nu \; dZ.
\end{align}


\subsection*{Acknowledgement} The authors would like to thank Prof. Hrusa for \dots 

%\printbibliography













\end{document}









